<div class="result-margin" *ngFor="let batch of searchResultVM" id="{{batch.BatchID.value}}">
  <ukho-card>
    <table class="attribute-table">
      <caption class="sr-only">Attributes for Batch {{batch.SerialNumber}} </caption>
      <ng-container *ngFor="let attributes of batch.batchAttributeList">
     <tr>
       <th *ngFor="let attribute of attributes.batchAttributeList">{{attribute.key}}</th>
     </tr>
     <tr>
       <td *ngFor="let attribute of attributes.batchAttributeList">{{attribute.value}}</td>
     </tr>
     </ng-container>
    </table>

    <ukho-expansion class="expansionLabel" heading="Choose files to download" [alignHeadingRight]=true
      [initialExpanded]=false>
      <table class="system-attribute-table">
        <caption class="sr-only">Details for Batch {{batch.SerialNumber}} </caption>
        <tr>
          <th>{{batch.BatchID.key}}</th>
          <th>{{batch.BatchPublishedDate.key}}</th>
          <th>{{batch.ExpiryDate.key}}</th>
        </tr>
        <tr>
          <td>{{batch.BatchID.value| uppercase}}</td>
          <td>{{batch.BatchPublishedDate.value| date:'dd/MM/yyyy HH:mm'}}</td>
          <td>{{batch.ExpiryDate.value| date:'dd/MM/yyyy HH:mm'}}</td>
        </tr>
      </table>

      <table ukho-table [dataSource]="batch.batchFileDetails.rowData">
        <caption class="sr-only">Dowload files for Batch {{batch.SerialNumber}}</caption>
        <ng-container ukhoColumnDef="FileName">
          <th ukho-header-cell *ukhoHeaderCellDef>FileName </th>
          <td ukho-cell *ukhoCellDef="let element">{{element.FileName}}</td>
        </ng-container>
        <ng-container ukhoColumnDef="MimeType">
          <th ukho-header-cell *ukhoHeaderCellDef>MimeType </th>
          <td ukho-cell *ukhoCellDef="let element">{{element.MimeType}}</td>
        </ng-container>
        <ng-container ukhoColumnDef="FileSize">
          <th ukho-header-cell *ukhoHeaderCellDef>FileSize </th>
          <td ukho-cell *ukhoCellDef="let element">{{element.FileSize}}</td>
        </ng-container>
        <ng-container ukhoColumnDef="Download">
          <th ukho-header-cell *ukhoHeaderCellDef>Download</th>
          <td ukho-cell *ukhoCellDef="let element">
            <button class="fileDownload fa fa-download fa-1x cursorPointer" tabindex="0" role="button"
              attr.data-file-download-batch-id="{{batch.BatchID.value}}"
              attr.aria-label="Download File for {{element.FileName}}"
              (click)="downloadFile($event.target, element)"></button>
          </td>
        </ng-container>
        <tr ukho-header-row *ukhoHeaderRowDef="batch.batchFileDetails.columnData"></tr>
        <tr ukho-row *ukhoRowDef="let row; columns: batch.batchFileDetails.columnData"></tr>
      </table>
      <ng-container>
        <div class="downloadAllElement">
          <div class="downloadAllDialogItem" *ngIf="!batch.allFilesZipSize">
            <ukho-dialogue id="downloadAllMessage{{batch.SerialNumber}}">
              <h3>'Download all' function will be available when the files have been prepared</h3>
              <div>
                You can select and download individual files, or try again later
              </div>
            </ukho-dialogue>
          </div>
          <div class="downloadAllButtonItem">
            <a [ngClass]="{isDownloadAllDisabled:!batch.allFilesZipSize}" href="javascript:void(0)"
              class="downloadAllTextRight" (click)="batch.allFilesZipSize && downloadAll(batch.BatchID.value)"
              [class.disabled]="!batch.allFilesZipSize" [attr.aria-disabled]="!batch.allFilesZipSize"
              [attr.aria-describedby]="!batch.allFilesZipSize ? 'downloadAllMessage' + batch.SerialNumber + '': ''">Download all <span class="sr-only">&nbsp;for batch {{batch.SerialNumber}}</span></a>
          </div>
        </div>
      </ng-container>
    </ukho-expansion>
  </ukho-card>
</div>