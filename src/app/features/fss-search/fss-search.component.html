<div class="spinner-wrapper" *ngIf="displayLoader" aria-live='polite' role="alert" aria-label="Results Loading"><i
    class="fas fa-spinner fa-pulse fa-3x" aria-hidden="true"></i></div>

<div class="container">
  <h1 id="main" tabindex="-1">Search files</h1>
  <p class="light">Complete the parameters to create a search query.</p>

  <div #ukhoTarget>

    <ukho-dialogue [type]='messageType' *ngIf="displayMessage" aria-live="polite" tabindex="-1">
      <h3>{{messageTitle}}</h3>
      <div>{{messageDesc}}</div>
      <div *ngIf="loginErrorDisplay">
        Please
        <button class="loginAction" (click)="refreshToken()" aria-label="Click here to Sign in">click here</button> to sign-in
      </div>
    </ukho-dialogue>
  </div>

  <app-fss-simplified-search *ngIf="activeSearchType === SearchTypeEnum.SimplifiedSearch"
    (ShowAdvancedSearchClicked)="ShowAdvancedSearchClicked()"
    (onSimplifiedSearchClicked)="onSimplifiedSearchClicked($event)"></app-fss-simplified-search>

  <app-fss-advanced-search *ngIf="activeSearchType === SearchTypeEnum.AdvancedSearch" #UkhoAdvanceSearch
    (ShowSimplifiedSearchClicked)="ShowSimplifiedSearchClicked()" 
    (onAdvancedSearchClicked)="onAdvancedSearchClicked($event)"
    [observablePopularSearch]="eventPopularSearch.asObservable()"
    [observableAdvancedSearchTokenRefresh]="eventAdvancedSearchTokenRefresh.asObservable()"></app-fss-advanced-search>

    <!-- <app-exchange-set></app-exchange-set> -->

  <div *ngIf="displaySearchResult">
    <a href="#skipResultsLink" class="skip-to-content-link skipResults section" *ngIf="activeSearchType === SearchTypeEnum.SimplifiedSearch" >Skip to Search Results </a>
    <div [ngClass]="activeSearchType === SearchTypeEnum.SimplifiedSearch ? 'SimplifiedSearch' : ''">
      
      <app-fss-simplified-filter id="gotoFilterMenu" *ngIf="activeSearchType === SearchTypeEnum.SimplifiedSearch" tabindex="-1"
      (onApplyFilterButtonClicked)="onApplyFilterButtonClicked($event)" [filterGroups]="filterGroups"></app-fss-simplified-filter>
      <div>
        <h2 id="skipResultsLink" tabindex="-1" #showSearchResult >
          <span class="totalResultLabel" *ngIf="searchResultTotal == 1" role="alert" aria-live="polite">{{this.searchResultTotal}} result found</span>
          <span class="totalResultLabel" *ngIf="searchResultTotal > 1" role="alert" aria-live="polite">{{this.searchResultTotal}} results found</span>
          <span *ngIf="searchResultTotal > pageRecordCount" class="paginatorLabel" role="alert" aria-live="polite"> {{this.paginatorLabel}}</span>
        </h2>
        <app-fss-search-results class="SimplifiedSearchResult" [searchResult]="searchResult" [currentPage]="currentPage"
          (handleTokenExpiry)="handleTokenExpiry()"></app-fss-search-results>
      </div>
    </div>
    <br />
    <div class="pagination">
      <ukho-paginator [label]="paginatorLabel" [pages]="pages" [currentPage]="currentPage"
        (pageChange)="pageChange($event)">
      </ukho-paginator>
      <a href="#gotoFilterMenu" class="skip-to-content-link SkipToFilter section" *ngIf="activeSearchType === SearchTypeEnum.SimplifiedSearch"  >Go to Filter </a>
    </div> 
</div>

<div *ngIf="activeSearchType === SearchTypeEnum.AdvancedSearch && displayPopularSearch">
  <br />
  <ukho-hr aria-hidden="true"></ukho-hr>
  <app-fss-popular-search-batches (popularSearchClicked)="popularSearchClicked($event)"></app-fss-popular-search-batches>
</div>